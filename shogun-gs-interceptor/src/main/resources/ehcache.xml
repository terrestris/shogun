<config
  xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
  xmlns='http://www.ehcache.org/v3'
  xmlns:jsr107='http://www.ehcache.org/v3/jsr107'
  xsi:schemaLocation="
    http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.8.xsd
    http://www.ehcache.org/v3/jsr107 http://www.ehcache.org/schema/ehcache-107-ext-3.8.xsd
">

  <!-- See https://www.ehcache.org/documentation/3.8/xml.html for documentation -->

  <service>
    <jsr107:defaults enable-management="false" enable-statistics="true" default-template="default" />
  </service>

  <!-- Persistent cache directory -->
  <persistence directory="shogun-ehcache"/>

  <!-- Default cache template -->
  <cache-template name="default">
    <expiry>
      <tti unit="nanos">1</tti>
    </expiry>
    <listeners>
      <listener>
        <class>de.terrestris.shogun.lib.listener.CacheLogger</class>
        <event-firing-mode>ASYNCHRONOUS</event-firing-mode>
        <event-ordering-mode>UNORDERED</event-ordering-mode>
        <events-to-fire-on>CREATED</events-to-fire-on>
        <events-to-fire-on>EXPIRED</events-to-fire-on>
        <events-to-fire-on>EVICTED</events-to-fire-on>
        <events-to-fire-on>REMOVED</events-to-fire-on>
        <events-to-fire-on>UPDATED</events-to-fire-on>
      </listener>
    </listeners>

    <!-- See https://www.ehcache.org/documentation/3.8/tiering.html#multiple-tier-setup -->
    <resources>
      <!-- Calculation of the heap size has an impact on the performance, make use of entries here -->
      <heap unit="entries">1</heap>
      <!-- Note: Data cached in the disk tier will persist even if the JVM stops! -->
<!--      <disk persistent="true" unit="MB">100</disk>-->
    </resources>
  </cache-template>
  <cache-template name="interceptor">
    <expiry>
      <none/>
    </expiry>
    <listeners>
      <listener>
        <class>de.terrestris.shogun.lib.listener.CacheLogger</class>
        <event-firing-mode>ASYNCHRONOUS</event-firing-mode>
        <event-ordering-mode>UNORDERED</event-ordering-mode>
        <events-to-fire-on>CREATED</events-to-fire-on>
        <events-to-fire-on>EXPIRED</events-to-fire-on>
        <events-to-fire-on>EVICTED</events-to-fire-on>
        <events-to-fire-on>REMOVED</events-to-fire-on>
        <events-to-fire-on>UPDATED</events-to-fire-on>
      </listener>
    </listeners>

    <!-- See https://www.ehcache.org/documentation/3.8/tiering.html#multiple-tier-setup -->
    <resources>
      <!-- Calculation of the heap size has an impact on the performance, make use of entries here -->
      <heap unit="entries">1000</heap>
      <offheap unit="MB">10</offheap>
      <!-- Note: Data cached in the disk tier will persist even if the JVM stops! -->
<!--      <disk persistent="true" unit="MB">100</disk>-->
    </resources>
  </cache-template>

  <cache alias="default-query-results-region" uses-template="default">
    <expiry>
      <tti unit="nanos">1</tti>
    </expiry>
    <heap>1</heap>
  </cache>

  <cache alias="default-update-timestamps-region" uses-template="default">
    <expiry>
      <tti unit="nanos">1</tti>
    </expiry>
    <heap>1</heap>
  </cache>

  <!-- Regions for shogun entities -->
  <cache alias="interceptorrules" uses-template="interceptor" />
  <cache alias="interceptorrule_query" uses-template="interceptor" />
  <cache alias="groupclasspermissions" uses-template="default" />
  <cache alias="groupinstancepermissions" uses-template="default" />
  <cache alias="permissions" uses-template="default" />
  <cache alias="permission" uses-template="default" />
  <cache alias="userclasspermissions" uses-template="default" />
  <cache alias="userinstancepermissions" uses-template="default" />
  <cache alias="applications" uses-template="default" />
  <cache alias="files" uses-template="default" />
  <cache alias="groups" uses-template="default" />
  <cache alias="layers" uses-template="default" />
  <cache alias="topics" uses-template="default" />
  <cache alias="users" uses-template="default" />

</config>
